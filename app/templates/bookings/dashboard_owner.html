{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2 class="fw-bold mb-4">Owner Dashboard</h2>

    <!-- Stats Row -->
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3">
            <div class="card shadow-sm text-center p-3 border-0">
                <div class="text-primary fs-2"><i class="bi bi-cash-stack"></i></div>
                <h5 class="mt-2">â‚¹{{ total_revenue }}</h5>
                <p class="text-muted small">Total Earnings</p>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card shadow-sm text-center p-3 border-0">
                <div class="text-success fs-2"><i class="bi bi-calendar-check"></i></div>
                <h5 class="mt-2">{{ total_rentals }}</h5>
                <p class="text-muted small">Total Bookings</p>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card shadow-sm text-center p-3 border-0">
                <div class="text-warning fs-2"><i class="bi bi-play-circle"></i></div>
                <h5 class="mt-2">{{ active_rentals }}</h5>
                <p class="text-muted small">Active Rentals</p>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card shadow-sm text-center p-3 border-0">
                <div class="text-danger fs-2"><i class="bi bi-exclamation-triangle"></i></div>
                <h5 class="mt-2">{{ late_returns }}</h5>
                <p class="text-muted small">Late Returns</p>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="d-flex flex-wrap gap-2 mb-4">
        <a href="{{ url_for('booking.list_facilities') }}" class="btn btn-primary">
            <i class="bi bi-building"></i> Manage My Facilities
        </a>
        <a href="{{ url_for('booking.my_bookings') }}" class="btn btn-outline-primary">
            <i class="bi bi-calendar-event"></i> View My Bookings
        </a>
    </div>

    <!-- Chart -->
    <div class="card shadow-sm border-0">
        <div class="card-body">
            <h5 class="card-title">Monthly Revenue</h5>
            <canvas id="revenueChart" height="100"></canvas>
        </div>
    </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('revenueChart').getContext('2d');
    const revenueChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ revenue_trends|map(attribute=0)|list|tojson }},
            datasets: [{
                label: 'Revenue',
                data: {{ revenue_trends|map(attribute=1)|list|tojson }},
                backgroundColor: 'rgba(13, 110, 253, 0.2)',
                borderColor: '#0d6efd',
                borderWidth: 2,
                fill: true,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>
{% endblock %}
